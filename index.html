<!DOCTYPE html>
<html lang="ko">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0">
    <meta name="description" content="대한민국 대통령 공식 홈페이지">
    <meta name="keywords" content="대한민국대통령, 윤석열, 탄핵하라, 제20대 대통령은, 이제, 탄핵속으로 사라져라, 국민의 짐, 윤대통령, 제20대 대통령 윤석열 퇴진하라">

    <meta property="og:type" content="website">
    <meta property="og:title" content="대한민국 대통령실">
    <meta property="og:url" content="https://www.president.go.kr">
    <meta property="og:site_name" content="대한민국 대통령실">
    <meta property="og:description" content="대한민국 대통령 공식 홈페이지">
    <meta property="og:image" content="https://www.president.go.kr/thumb_img_new.jpg">

    <style>
        html,body,div,p,a,span,ul,li,h3{
            margin:0;
            padding:0;
            font-family: 'Pretendard', sans-serif;
        }
        a{text-decoration:none;}
        .container{
            width: 100%;
            height: auto;
            display: table;
        }
        .contents{
            position: relative;
            display: table-cell;
            vertical-align: middle;
            width: 100%;
            margin: 0 auto;
            text-align: center;
        }
        .contents .top_logo{
            display:block;
            max-width: 469px;
            margin: 0 auto 60px auto;
        }

        .contents .top_logo img {
            width:50%;
            height:auto;
        }

        .contents h3{
            font-size: 64px;
            margin-bottom: 15px;
            letter-spacing: -0.5px; /* 글자 간격 줄임 */
            line-height: 1.2; /* 줄 간격 조정 */
        }
        .contents h3 span{color:#ccc;}
        .contents .text{
            font-size: 21px;
            color: #585858;
            letter-spacing: -0.4px; /* 글자 간격 줄임 */
            line-height: 1.4; /* 줄 간격 조정 */
        }
        .contents .text.txt{
            display: block;
            margin-top: 15px; /* 여백 줄임 */
        }
        .contents .btn{
            text-align: center;
            margin-top: 40px;
        }
        .contents .btn a{
            font-size: 16px;
            background-color: #082e59;
            color: #fff;
            width: 300px;
            display: block;
            margin: 0 auto;
            height: 45px;
            line-height: 42px;
            border-radius: 5px;
            cursor: not-allowed;
        }

        .comment-section {
            margin-top: 50px;
            text-align: left;
            width: 80%;
            margin-left: auto;
            margin-right: auto;
        }
        .comment-section h4 {
            font-size: 24px;
            margin-bottom: 20px;
        }
        .comment-section .comment {
            margin-bottom: 10px; /* 기존 15px에서 줄임 */
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px; /* 간격 축소 */
            display: flex;
            justify-content: space-between;
            align-items: center; /* 세로 정렬 조정 */
        }
        .comment-section .comment span.nickname {
            font-weight: bold;
            color: #082e59;
        }
        .comment-section .delete-btn {
            color: red;
            cursor: pointer;
            font-size: 12px;
            display: inline; /* 항상 표시 */
        }
        .comment-section textarea {
            width: 100%;
            margin-top: 10px;
            height: 100px;
            padding: 10px;
            font-size: 14px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .comment-section input {
            margin-top: 10px;
            padding: 10px;
            font-size: 14px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .comment-section .submit-btn {
            background-color: #082e59;
            color: #fff;
            border: none;
            margin-top: 10px;
            padding: 10px 20px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
        }
        .comment-section .announcement {
            background-color: rgba(8, 46, 89, 0.1);
            border: 1px solid #082e59;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            color: #082e59;
            font-size: 16px;
            font-weight: bold;
        }
        .comment-section .admin-announcement {
            display: none;
            margin-top: 20px;
        }
        body {
            background-color: #fff;
            color: #000;
            transition: background-color 0.3s, color 0.3s;
        }
        body.dark-mode {
            background-color: #121212;
            color: #ffffff;
        }
    </style>
    
    <title>대통령을 찾을 수 없습니다</title>

</head>
<body>

<div class="container">
    <div class="contents">
        <p class="top_logo"><img src="https://www.president.go.kr/assets/images/common/logo-navy.svg" alt="대통령실 로고 이미지"></p>
        <h3><span>[</span> 대통령(윤석열)을 찾을 수 없습니다 <span>]</span></h3>
        <span class="text">
            입력하신 대통령을 찾을 수 없거나 서비스 연결 오류일 수 있습니다.<br>
            검색어를를 확인하신 후 다시 이용해 주시기 바랍니다.
        </span>
        <span class="text txt">감사합니다.</span>

        <p class="btn"><a href="#">윤석열 탄핵 시위하러 바로가기</a></p>
    </div>
</div>

<div class="comment-section">
    <button class="submit-btn" id="toggleMode">다크모드</button>
    <div class="announcement" id="announcement">
        관리자 공지: 개인 운영사이트임을 알려드리며 현제 모종의 오류로 댓글, 공지기능이 정상적으로 작동하고 있지 않고있습니다. 사용자 여러분들의 양해 바랍니다. (2024-12-28 09:30:00).
    </div>
    <div class="admin-announcement" id="adminAnnouncement">
        <textarea id="announcementInput" placeholder="공지 내용을 작성하세요"></textarea>
        <button class="submit-btn" onclick="updateAnnouncementToServer()">공지 등록</button>
    </div>
</div>

<script>
    const SERVER_URL = "http://localhost:5000";
    const commentsContainer = document.getElementById('comments');
    const announcementElement = document.getElementById('announcement');
    const adminAnnouncementElement = document.getElementById('adminAnnouncement');
    let isAdminVerified = false;

    // 다크모드 토글
    const toggleModeBtn = document.getElementById('toggleMode');
    toggleModeBtn.addEventListener('click', () => {
        document.body.classList.toggle('dark-mode');
        toggleModeBtn.textContent = document.body.classList.contains('dark-mode') ? '라이트모드' : '다크모드';
    });

    async function loadCommentsFromServer() {
        try {
            const response = await fetch(`${SERVER_URL}/get-comments`);
            const comments = await response.json();
            renderComments(comments);
        } catch (error) {
            console.error('댓글 불러오기 오류:', error);
        }
    }

    async function saveCommentToServer() {
        const nickname = document.getElementById('nicknameInput').value;
        const comment = document.getElementById('commentInput').value;

        if (!nickname || !comment) {
            alert('닉네임과 댓글을 모두 입력해주세요.');
            return;
        }

        try {
            await fetch(`${SERVER_URL}/save-comment`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ nickname, comment })
            });
            loadCommentsFromServer();
        } catch (error) {
            console.error('댓글 저장 오류:', error);
        }
    }

    async function deleteComment(index) {
        if (!isAdminVerified) {
            alert('관리자 권한이 필요합니다.');
            return;
        }

        try {
            await fetch(`${SERVER_URL}/delete-comment`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ index })
            });
            loadCommentsFromServer();
        } catch (error) {
            console.error('댓글 삭제 오류:', error);
        }
    }

    function renderComments(comments) {
        commentsContainer.innerHTML = ''; // 기존 댓글 초기화
        comments.forEach((comment, index) => {
            const commentElement = document.createElement('div');
            commentElement.className = 'comment';
            commentElement.innerHTML = `
                <span class="nickname">${comment.nickname}</span>: 
                <span>${comment.comment}</span>
                <span class="delete-btn" onclick="deleteComment(${index})" style="display: ${isAdminVerified ? 'inline' : 'none'};">삭제</span>
            `;
            commentsContainer.appendChild(commentElement);
        });
    }

    async function loadAnnouncementFromServer() {
        try {
            const response = await fetch(`${SERVER_URL}/get-announcement`);
            const { announcement } = await response.json();
            announcementElement.textContent = `관리자 공지: ${announcement}`;
        } catch (error) {
            console.error('공지 불러오기 오류:', error);
        }
    }

    async function updateAnnouncementToServer() {
        const newAnnouncement = document.getElementById('announcementInput').value;
        if (!newAnnouncement) {
            alert('공지 내용을 입력해주세요.');
            return;
        }

        try {
            await fetch(`${SERVER_URL}/update-announcement`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ announcement: newAnnouncement })
            });
            loadAnnouncementFromServer();
        } catch (error) {
            console.error('공지 업데이트 오류:', error);
        }
    }

    function verifyAdminCode() {
        const adminCodeInput = document.getElementById('adminCodeInput').value.trim();
        if (adminCodeInput === 'admin1234') {
            isAdminVerified = true;
            alert('관리자 권한이 확인되었습니다.');
            adminAnnouncementElement.style.display = 'block'; // 관리자 공지 작성 영역을 보이게 함
            loadCommentsFromServer();  // 관리자 인증 후 댓글 목록을 다시 불러오기
        } else {
            alert('관리자 코드가 올바르지 않습니다.');
        }
    }

    // 초기 데이터 로드
    loadCommentsFromServer();
    loadAnnouncementFromServer();
</script>

</body>
</html>
